%p#notice= notice

%ul.breadcrumb
  %li
    = link_to @project.company.name, @project.company
    %span.divider /
  %li.active= @project.name

.row
  .span12
    .btn-group.pull-right
      - if permitted_to? :update, :projects
        = link_to 'Edit', edit_project_path(@project), :class => 'btn'
      - if permitted_to? :destroy, :projects
        = link_to 'Delete', @project, {:method => :delete, :class => 'btn'}
    %h1= @project.name
    .progress.progress_striped{ :style => 'width: 200px;'}
      .bar{ :style => "width: #{@project.completion * 100.0}%;" }
    = @project.goal_date

.row
  .span10
    - @project.tasks.order('complete asc, date(due) asc').each do |task|
      .row
        .span10.offset1
          .btn-group.pull-right
            - if permitted_to? :update, task
              = link_to 'Edit', edit_task_path(task), :class => 'btn'
            - if permitted_to? :destroy, task
              = link_to 'Delete', task, {:method => :delete, :class => 'btn'}
          = check_box_tag :complete, 1, task.complete, :disabled => true
          = link_to task.title, task
      .row
        .span10.offset1
          = task.due
          = task.creator.email
          = task.owner.email
      .row
        .span10.offset1
          = task.description
          %hr
    .row
      .span10.offset1
        .btn-group
          = link_to 'New Task', new_task_path(:project_id => @project.id), :class => 'btn btn-primary'
